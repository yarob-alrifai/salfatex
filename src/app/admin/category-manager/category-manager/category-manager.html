<section class="p-8 bg-gray-50 min-h-screen">
  <!-- Header -->
  <header class="mb-8 text-center">
    <h2 class="text-3xl font-bold text-indigo-600">ุฅุฏุงุฑุฉ ุงูุชุตูููุงุช</h2>
    <p class="text-gray-600 mt-2">
      ูู ุจุฅูุดุงุก ุชุตูููุงุช ุฌุฏูุฏุฉ ูุน ุตูุฑุฉ ุชุนุฑูููุฉ ููุตู ูุฎุชุตุฑ ูุชุงุจุน ุชุนุฏูููุง ุจุณูููุฉ.
    </p>
  </header>

  <!-- Create form -->
  <form
    [formGroup]="form"
    (ngSubmit)="createCategory()"
    class="grid grid-cols-1 md:grid-cols-2 gap-6 bg-white p-6 rounded-xl shadow"
  >
    <label class="flex flex-col text-right">
      <span class="mb-1 font-medium text-gray-700">ุงุณู ุงูุชุตููู</span>
      <input
        formControlName="name"
        placeholder="ุงูุฃููุดุฉ"
        class="border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-400"
      />
    </label>

    <label class="flex flex-col text-right md:col-span-2">
      <span class="mb-1 font-medium text-gray-700">ุงููุตู</span>
      <textarea
        formControlName="description"
        rows="3"
        placeholder="ุชูุงุตูู ุนู ุงูุชุตููู"
        class="border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-indigo-400"
      ></textarea>
    </label>

    <label class="flex flex-col text-right">
      <span class="mb-1 font-medium text-gray-700">ุตูุฑุฉ ุงูุชุตููู</span>
      <input
        type="file"
        accept="image/*"
        (change)="onImageChange($event)"
        class="border border-dashed border-indigo-300 rounded-lg p-3 bg-indigo-50 text-sm"
      />
    </label>

    <button
      type="submit"
      class="md:col-span-2 bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-6 rounded-lg shadow transition"
    >
      โ ุญูุธ ุงูุชุตููู
    </button>

    <p class="md:col-span-2 text-center text-green-600 font-medium" *ngIf="feedback()">
      {{ feedback() }}
    </p>
  </form>

  <!-- Category table -->
  <section class="mt-10 space-y-6" *ngIf="categories$ | async as categories">
    <div class="bg-white rounded-xl shadow overflow-hidden">
      <div class="overflow-x-auto">
        <table class="min-w-full divide-y divide-gray-200 text-right">
          <thead class="bg-gray-100 text-gray-700 text-sm">
            <tr>
              <th class="px-4 py-3 font-semibold">ุงูุตูุฑุฉ</th>
              <th class="px-4 py-3 font-semibold">ุงูุงุณู</th>
              <th class="px-4 py-3 font-semibold">ุงููุตู</th>
              <th class="px-4 py-3 font-semibold">ุงูุฅุฌุฑุงุกุงุช</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-gray-200 text-sm text-gray-700">
            <tr *ngFor="let category of categories" class="hover:bg-gray-50">
              <td class="px-4 py-3">
                <div class="flex justify-end">
                  <img
                    *ngIf="category.imageUrl; else placeholder"
                    [src]="category.imageUrl"
                    [alt]="category.name"
                    class="w-14 h-14 rounded-lg object-cover border border-gray-200"
                  />
                  <ng-template #placeholder>
                    <span
                      class="inline-flex items-center justify-center w-14 h-14 rounded-lg bg-gray-100 text-gray-400 text-xl"
                    >
                      ๐ผ๏ธ
                    </span>
                  </ng-template>
                </div>
              </td>
              <td class="px-4 py-3 font-medium text-gray-900">{{ category.name }}</td>
              <td class="px-4 py-3 text-gray-600">{{ category.description || 'ูุง ููุฌุฏ ูุตู' }}</td>
              <td class="px-4 py-3">
                <div class="flex items-center justify-end gap-2">
                  <button
                    type="button"
                    (click)="openEdit(category)"
                    class="bg-amber-500 hover:bg-amber-600 text-white py-1 px-3 rounded-lg shadow transition"
                  >
                    โ๏ธ ุชุนุฏูู
                  </button>
                  <button
                    type="button"
                    (click)="deleteCategory(category)"
                    class="bg-red-500 hover:bg-red-600 text-white py-1 px-3 rounded-lg shadow transition"
                  >
                    ๐๏ธ ุญุฐู
                  </button>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <div *ngIf="!categories.length" class="p-6 text-center text-gray-500">
        ูุง ุชูุฌุฏ ุชุตูููุงุช ูุถุงูุฉ ุจุนุฏ.
      </div>
    </div>
  </section>

  <!-- Edit modal -->
  <div
    class="fixed inset-0 z-40 flex items-center justify-center bg-black/40 backdrop-blur"
    *ngIf="isEditModalOpen()"
  >
    <div
      class="w-full max-w-2xl bg-white max-h-[90vh] rounded-2xl shadow-xl p-6 space-y-6 overflow-y-auto"
    >
      <div class="flex items-center justify-between">
        <h3 class="text-xl font-semibold text-gray-800">ุชุนุฏูู ุงูุชุตููู</h3>
        <button
          type="button"
          (click)="closeEditModal()"
          class="text-gray-500 hover:text-gray-700"
          aria-label="ุฅุบูุงู"
        >
          โ๏ธ
        </button>
      </div>

      <form
        class="grid grid-cols-1 md:grid-cols-2 gap-4"
        [formGroup]="editForm"
        (ngSubmit)="saveCategoryEdits()"
      >
        <label class="flex flex-col text-right">
          <span class="mb-1 font-medium text-gray-700">ุงุณู ุงูุชุตููู</span>
          <input
            formControlName="name"
            class="border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-indigo-400"
          />
        </label>

        <label class="flex flex-col text-right md:col-span-2">
          <span class="mb-1 font-medium text-gray-700">ุงููุตู</span>
          <textarea
            formControlName="description"
            rows="3"
            class="border border-gray-300 rounded-lg p-3 focus:outline-none focus:ring-2 focus:ring-indigo-400"
          ></textarea>
        </label>

        <label class="flex flex-col text-right md:col-span-2">
          <span class="mb-1 font-medium text-gray-700">ุชุบููุฑ ุงูุตูุฑุฉ</span>
          <input
            type="file"
            accept="image/*"
            (change)="onEditImageChange($event)"
            class="border border-dashed border-indigo-300 rounded-lg p-3 bg-indigo-50 text-sm"
          />
          <span class="text-xs text-gray-500 mt-1"
            >ุงุชุฑู ุงูุญูู ูุงุฑุบูุง ููุงุญุชูุงุธ ุจุงูุตูุฑุฉ ุงูุญุงููุฉ.</span
          >
        </label>

        <div class="md:col-span-2 flex items-center justify-end gap-2">
          <button
            type="button"
            (click)="closeEditModal()"
            class="px-4 py-2 rounded-lg border border-gray-300 text-sm hover:bg-gray-100"
          >
            ุฅูุบุงุก
          </button>
          <button
            type="submit"
            class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-6 rounded-lg shadow transition"
          >
            ๐พ ุญูุธ ุงูุชุนุฏููุงุช
          </button>
        </div>

        <p class="md:col-span-2 text-center text-red-600 font-medium" *ngIf="editFeedback()">
          {{ editFeedback() }}
        </p>
      </form>
    </div>
  </div>
</section>
