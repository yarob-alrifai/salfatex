<div class="admin-contact" [class.admin-contact--loading]="loading()">
  <header class="admin-contact__header">
    <div>
      <h1 class="admin-contact__title">إعدادات صفحة الاتصال</h1>
      <p class="admin-contact__subtitle">
        قم بتحديث بيانات التواصل التي ستظهر للزوار في صفحة "اتصل بنا".
      </p>
    </div>
    <button type="button" class="admin-contact__save" (click)="save()" [disabled]="loading()">
      <span>حفظ التعديلات</span>
      @if (loading()) {
      <svg class="admin-contact__spinner" viewBox="0 0 24 24" fill="none">
        <circle
          class="opacity-25"
          cx="12"
          cy="12"
          r="10"
          stroke="currentColor"
          stroke-width="4"
        ></circle>
        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8v4a4 4 0 00-4 4H4z"></path>
      </svg>
      }
    </button>
  </header>

  @if (feedback()) {
  <div class="admin-contact__feedback">{{ feedback() }}</div>
  }

  <form [formGroup]="form" class="admin-contact__form" novalidate>
    <div class="admin-contact__grid">
      <label class="admin-contact__field">
        <span class="admin-contact__label">رقم الهاتف الأرضي</span>
        <input
          class="admin-contact__input"
          type="text"
          formControlName="phone"
          placeholder="مثال: +7 495 000 0000"
          dir="ltr"
        />
        @if (form.controls.phone.invalid && form.controls.phone.touched) {
        <span class="admin-contact__error">يجب أن يحتوي رقم الهاتف على أرقام ورموز فقط.</span>
        }
      </label>

      <label class="admin-contact__field">
        <span class="admin-contact__label">رقم الموبايل</span>
        <input
          class="admin-contact__input"
          type="text"
          formControlName="mobile"
          placeholder="مثال: +963 9X XXX XXXX"
          dir="ltr"
        />
        @if (form.controls.mobile.invalid && form.controls.mobile.touched) {
        <span class="admin-contact__error">يجب أن يحتوي رقم الموبايل على أرقام ورموز فقط.</span>
        }
      </label>

      <label class="admin-contact__field">
        <span class="admin-contact__label">البريد الإلكتروني</span>
        <input
          class="admin-contact__input"
          type="email"
          formControlName="email"
          placeholder="example@email.com"
          dir="ltr"
        />
        @if (form.controls.email.invalid && form.controls.email.touched) {
        <span class="admin-contact__error">يرجى إدخال بريد إلكتروني صالح.</span>
        }
      </label>

      <label class="admin-contact__field admin-contact__field--full">
        <span class="admin-contact__label">العنوان</span>
        <textarea
          class="admin-contact__textarea"
          formControlName="address"
          rows="3"
          placeholder="أدخل العنوان الكامل"
        ></textarea>
      </label>

      <label class="admin-contact__field">
        <span class="admin-contact__label">رابط الواتساب</span>
        <input
          class="admin-contact__input"
          type="url"
          formControlName="whatsappUrl"
          placeholder="https://wa.me/..."
          dir="ltr"
        />
        @if (form.controls.whatsappUrl.invalid && form.controls.whatsappUrl.touched) {
        <span class="admin-contact__error">يرجى إدخال رابط صحيح يبدأ بـ https://.</span>
        }
      </label>

      <label class="admin-contact__field">
        <span class="admin-contact__label">رابط التلغرام</span>
        <input
          class="admin-contact__input"
          type="url"
          formControlName="telegramUrl"
          placeholder="https://t.me/..."
          dir="ltr"
        />
        @if (form.controls.telegramUrl.invalid && form.controls.telegramUrl.touched) {
        <span class="admin-contact__error">يرجى إدخال رابط صحيح يبدأ بـ https://.</span>
        }
      </label>
    </div>

    <section class="admin-contact__qr">
      <div>
        <h2 class="admin-contact__section-title">رمز QR للواتساب</h2>
        <p class="admin-contact__section-subtitle">
          يمكنك رفع صورة رمز QR ليتمكن العملاء من مسحها مباشرة.
        </p>
      </div>
      <div class="admin-contact__qr-controls">
        <label class="admin-contact__upload">
          <input
            id="whatsappQrInput"
            type="file"
            accept="image/*"
            (change)="onWhatsappQrChange($event)"
          />
          <span>رفع صورة جديدة</span>
        </label>
        <button type="button" class="admin-contact__remove" (click)="clearWhatsappQr()">
          إزالة الرمز
        </button>
      </div>
    </section>

    <div class="admin-contact__qr-preview">
      @if (whatsappQrPreview()) {
      <img [src]="whatsappQrPreview()" alt="معاينة رمز QR للواتساب" />
      } @else {
      <div class="admin-contact__qr-empty" aria-hidden="true"></div>
      }
    </div>
  </form>
</div>
